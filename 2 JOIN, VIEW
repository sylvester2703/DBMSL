drop database practical2;
create database practical2;
use practical2;
create table project(
pid int primary key, 
pname varchar(100), 
ptype char(100), 
pduration int);
insert into project values 
(1,"abc","AI",200), 
(2,"def","ERP",250), 
(3,"ghi","ERP",300), 
(4,"jkl","LLP",350);
select * from project;

create table employee(
eid int primary key, 
ename varchar(100), 
qualification char(100), 
joining_date date);
insert into employee values 
(101,"Sylvester","PhD","2022-03-23"), 
(102,"Hemant","12th","2024-05-17"), 
(103,"Nidhi","B.E","2021-07-21"), 
(104,"Avani","PhD","2020-09-10");
select * from employee;

create table work(
pid int,
eid int,
foreign key (pid) references project(pid), 
foreign key(eid) references employee(eid));
insert into work values 
(1,101),
(2,102),
(3,103),
(4,104);
select * from work;

create view 
erp_project as select E.ename 
from work W join project P 
on W.pid=P.pid join employee E 
on E.eid=W.eid where P.ptype="ERP";
select * from erp_project;

create view qualification_BE 
as select E.eid, E.ename, E.joining_date 
from employee E where E.qualification="B.E";
select * from  qualification_BE;

create view hrs as select E.ename, P.ptype 
from work W join employee E 
on W.eid=E.eid join project P 
on W.eid=P.pid where P.pduration>300;
select * from hrs;

create view time as select E.ename, P.ptype 
from work W join employee E 
on W.eid=E.eid join project P 
on W.eid=P.pid where P.pduration >300;
select * from time;

create view more_than_300hrs 
as select E.ename, P.ptype 
from work W join employee E 
on W.eid=E.eid join project P 
on W.pid=P.pid where P.pduration >300;
select * from more_than_300hrs ;

select pname from project 
where pduration>(select avg(pduration) from project);

select P.pname from work W 
join project P on W.pid=P.pid 
join employee E on W.eid=E.eid 
where E.qualification!="MSC";

select ename from employee 
where joining_date= (select max(j_date) from employee);
